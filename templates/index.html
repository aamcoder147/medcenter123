<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareConnect - Book Your Clinic Appointment Seamlessly</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">

        <style>
        /* --- :root Variables --- */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-accent-light: #e0f2f2;
            --bg-accent-very-light: #f0fafa;
            --border-color: #e5e7eb;
            --border-color-strong: #d1d5db;
            --text-dark: #1f2937;
            --text-medium: #4b5563;
            --text-light: #ffffff;
            --accent-primary: #007A7A;
            --accent-primary-dark: #005F5F;
            --accent-primary-light: #4DB6AC;
            --accent-warm: #F2A900;
            --accent-warm-dark: #D99700;
            --success: #10b981;
            --error: #ef4444;
            --info: #3b82f6;
            --shadow-color: rgba(0, 50, 50, 0.06);
            --shadow-color-medium: rgba(0, 50, 50, 0.1);
            --shadow-color-strong: rgba(0, 50, 50, 0.15);
            --transition-speed: 0.3s;
            --transition-ease: ease-in-out;
            --scroll-animation-duration: 0.6s;
            --stagger-delay: 0.12s;
            --counter-animation-duration: 1500ms;
        }

        /* --- Base & Global Styles --- */
        html { scroll-behavior: smooth; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: var(--bg-secondary);
            color: var(--text-dark);
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .container { width: 90%; max-width: 1280px; margin: 0 auto; padding: 0 1rem; }
        .section-padding { padding: 5rem 0; }
        .section-padding-sm { padding: 3rem 0; }
        .section-title { text-align: center; margin-bottom: 3rem; font-size: 2rem; font-weight: 700; color: var(--text-dark); font-family: 'Lato', sans-serif; position: relative; padding-bottom: 0.8rem; }
        .section-title::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 70px; height: 4px; background-color: var(--accent-primary); border-radius: 2px; }
        .section-subtitle { text-align: center; color: var(--text-medium); max-width: 600px; margin: -2rem auto 3rem auto; font-size: 1.05rem; }

        /* --- Subtle Section Background Gradients --- */
        .featured-plcs-section, .doctors-section, .site-reviews-section { background: linear-gradient(to bottom, var(--bg-primary) 0%, #fdfdfd 100%); }
        .featured-facility-types-section { background: linear-gradient(to bottom, var(--bg-secondary) 0%, #f7f8fa 100%); }
        .how-it-works-section { background: linear-gradient(to bottom, var(--bg-primary) 0%, #fbfcfc 100%); }
        .trust-factors-section, #site-review-form-section { background: linear-gradient(to bottom, var(--bg-accent-very-light) 0%, #eafafa 100%); }

        /* --- Accessibility: Focus Styles --- */
        *:focus-visible { outline: 2px solid var(--accent-primary); outline-offset: 2px; box-shadow: 0 0 0 3px rgba(0, 122, 122, 0.25); border-radius: 4px; }
        select:focus, input[type="text"]:focus { outline: none; }
        select:focus-visible, input[type="text"]:focus-visible { outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 3px rgba(0, 122, 122, 0.15); }
        .btn:focus-visible { box-shadow: 0 2px 4px var(--shadow-color), 0 0 0 3px rgba(0, 122, 122, 0.25); }
        .specialty-card:focus-visible, .facility-type-card:focus-visible, .plc-card:focus-visible { outline: 2px solid var(--accent-primary); outline-offset: 1px; box-shadow: 0 8px 15px var(--shadow-color-medium), 0 0 0 3px rgba(0, 122, 122, 0.15); }
        .doctor-card:focus-visible { outline: 2px solid var(--accent-primary); outline-offset: 2px; box-shadow: 0 8px 15px var(--shadow-color-strong), 0 0 0 3px rgba(0, 122, 122, 0.15); }

        /* --- Animations --- */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInLeft { from { opacity: 0; transform: translateX(-35px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(35px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.85); } to { opacity: 1; transform: scale(1); } }
        @keyframes blinkCursor { 50% { border-color: transparent; } }

        /* Scroll Reveal Base Class */
        .reveal-on-scroll { opacity: 0; will-change: opacity, transform; animation-fill-mode: forwards; }
        .reveal-on-scroll.is-visible { animation-name: fadeInUp; animation-duration: var(--scroll-animation-duration); animation-timing-function: ease-out; }
        .reveal-left.is-visible { animation-name: fadeInLeft; }
        .reveal-right.is-visible { animation-name: fadeInRight; }
        .reveal-zoom.is-visible { animation-name: zoomIn; }

        /* --- Navbar --- */
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 5%; background: var(--bg-primary); position: sticky; top: 0; z-index: 1000; transition: box-shadow var(--transition-speed) var(--transition-ease), padding var(--transition-speed) var(--transition-ease), background-color var(--transition-speed) var(--transition-ease); border-bottom: 1px solid var(--border-color); }
        .navbar.scrolled { box-shadow: 0 3px 8px var(--shadow-color-medium); padding: 0.8rem 5%; background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(5px); }
        .logo { font-size: 1.9rem; font-weight: 700; color: var(--accent-primary); font-family: 'Lato', sans-serif; text-decoration: none; display: flex; align-items: center; gap: 0.6rem; transition: transform var(--transition-speed) var(--transition-ease); }
        .logo i { font-size: 1.7rem; }
        .logo:hover { transform: scale(1.03); }
        .nav-actions { display: flex; gap: 0.9rem; align-items: center; }

        /* --- Buttons --- */
        .btn { padding: 0.7rem 1.5rem; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.95rem; text-align: center; transition: all var(--transition-speed) var(--transition-ease); border: 1px solid transparent; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 0.6rem; line-height: 1.2; box-shadow: 0 2px 4px var(--shadow-color); }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 12px var(--shadow-color-medium); }
        .btn:active { transform: translateY(0px); box-shadow: 0 2px 4px var(--shadow-color); }
        .btn-primary { background-color: var(--accent-primary); color: var(--text-light); border-color: var(--accent-primary); margin: 0; }
        .btn-primary:hover { background-color: var(--accent-primary-dark); border-color: var(--accent-primary-dark); }
        .btn-secondary { background-color: var(--bg-secondary); color: var(--accent-primary); border-color: var(--border-color); box-shadow: none; }
        .btn-secondary:hover { background-color: var(--bg-accent-very-light); border-color: var(--accent-primary-light); color: var(--accent-primary-dark); }
        .btn-link { background: none; border: none; box-shadow: none; color: var(--accent-primary); padding: 0; font-weight: 600; }
        .btn-link:hover { color: var(--accent-primary-dark); text-decoration: underline;}
        .btn-small { padding: 0.4rem 0.9rem; font-size: 0.85rem; gap: 0.4rem; }

        /* --- Hero Section --- */
        .hero-section { background-color: var(--bg-primary); padding: 6rem 5% 5rem; text-align: center; border-bottom: 1px solid var(--border-color); overflow: visible; }
        .hero-title, .hero-subtitle, .typing-effect-container { opacity: 0; animation: fadeInUp 0.8s ease-out 0.2s forwards; }
        .hero-subtitle { animation-delay: 0.35s; }
        .typing-effect-container { animation-delay: 0.5s; }
        .hero-title { font-size: 2.8rem; margin-bottom: 1rem; color: var(--text-dark); font-weight: 700; font-family: 'Lato', sans-serif; line-height: 1.3; }
        .hero-title span { color: var(--accent-primary); }
        .hero-subtitle { font-size: 1.2rem; color: var(--text-medium); margin-bottom: 2rem; max-width: 700px; margin-left: auto; margin-right: auto; }
        .typing-effect-container { min-height: 32px; margin-bottom: 3rem; font-size: 1.2rem; color: var(--accent-primary-dark); font-weight: 600; }
        #text { border-right: 3px solid var(--accent-primary); padding-right: 6px; display: inline-block; white-space: nowrap; overflow: hidden; vertical-align: bottom; animation: blinkCursor 0.7s infinite steps(1); }

        /* --- Search Area Container (within Hero) --- */
        .search-area-container { border: 1px solid var(--border-color-strong); border-radius: 12px; padding: 2.5rem 2rem; margin: 3rem auto 0 auto; background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(4px); max-width: 1100px; box-shadow: 0 8px 25px rgba(0, 50, 50, 0.1); display: flex; flex-direction: column; gap: 1.5rem; align-items: center; opacity: 0; animation: fadeInUp 0.8s ease-out 0.65s forwards; }
        .search-form { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem; width: 100%; align-items: center; }
        .input-group { position: relative; width: 100%; }
        .input-group i { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-medium); font-size: 1em; transition: color var(--transition-speed) var(--transition-ease); pointer-events: none; }
        select, input[type="text"] { width: 100%; padding: 0.9rem 0.9rem 0.9rem 2.8rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-primary); color: var(--text-dark); font-size: 1rem; transition: border-color var(--transition-speed) var(--transition-ease), box-shadow var(--transition-speed) var(--transition-ease); height: 48px; }
        select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%234b5563' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M7.646 11.854a.5.5 0 0 0 .708 0l4-4a.5.5 0 0 0-.708-.708L8 10.793 4.354 7.146a.5.5 0 1 0-.708.708l4 4z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; padding-right: 3rem; cursor: pointer; }
        .input-group:focus-within i { color: var(--accent-primary); }
        .search-button-container { display: flex; justify-content: center; width: 100%; margin-top: 1rem; gap: 1rem; }
        .search-button-container .btn.search-btn { flex-basis: 220px; flex-grow: 0; width: auto; padding: 0.8rem 2rem; font-size: 1.05rem; }

        /* --- How It Works Section --- */
        .how-it-works-grid, .how-it-works-grid-standalone { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2.5rem; text-align: center; margin-top: 4rem; }
        .how-it-works-step { padding: 2rem; transition: transform 0.3s ease, box-shadow 0.3s ease; background: var(--bg-primary); border-radius: 8px; box-shadow: 0 4px 8px var(--shadow-color); border: 1px solid var(--border-color); }
        .how-it-works-step .icon { font-size: 3rem; color: var(--accent-primary); margin-bottom: 1.5rem; display: inline-block; transition: transform 0.3s ease; }
        .how-it-works-step h3 { font-size: 1.2rem; font-weight: 700; margin-bottom: 0.8rem; color: var(--text-dark); }
        .how-it-works-step p { color: var(--text-medium); font-size: 0.95rem; }
        .how-it-works-step:hover { transform: translateY(-10px); box-shadow: 0 10px 20px var(--shadow-color-medium); }
        .how-it-works-step:hover .icon { transform: scale(1.15) rotate(-8deg); color: var(--accent-primary-dark); }
        .how-it-works-section { border-top: 1px solid var(--border-color); }

        /* --- Featured Sections (Specialties, Facility Types, PLCs) --- */
        .featured-specialties-grid, .featured-facility-types-grid, .featured-plcs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.8rem; }

        /* --- Individual Card Styles (Specialty, Facility Type, PLC) --- */
        .specialty-card, .facility-type-card, .plc-card { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; text-align: center; transition: all var(--transition-speed) var(--transition-ease); box-shadow: 0 2px 5px var(--shadow-color); display: flex; flex-direction: column; align-items: center; cursor: pointer; min-height: 210px; justify-content: space-between; overflow: hidden; position: relative; }
        .specialty-card .icon, .facility-type-card .icon, .plc-card .icon { font-size: 2.5rem; color: var(--accent-primary-light); margin-top: 1rem; transition: all 0.3s ease; flex-grow: 1; display: flex; align-items: center; justify-content: center; }
        .specialty-card h4, .facility-type-card h4, .plc-card h4 { font-size: 1.0rem; font-weight: 600; color: var(--text-dark); line-height: 1.3; padding: 0 0.5rem; margin-top: auto; margin-bottom: 0.5rem; transition: color 0.3s ease; }
        .plc-photo { width: 100%; height: 110px; object-fit: cover; border-radius: 4px 4px 0 0; display: block; border-bottom: 1px solid var(--border-color); margin-bottom: 0.8rem; transition: transform 0.3s ease; }
        .plc-card .icon + h4 { margin-top: 0.8rem; }
        .plc-details-button-container { width: 100%; margin-top: 0.8rem; padding-bottom: 0.2rem; }
        .plc-details-btn { width: calc(100% - 1rem); margin: 0 auto; }
        .specialty-card:hover, .facility-type-card:hover, .plc-card:hover { transform: translateY(-8px) scale(1.03); border-color: var(--accent-primary); box-shadow: 0 8px 18px var(--shadow-color-medium); }
        .specialty-card:hover h4, .facility-type-card:hover h4, .plc-card:hover h4 { color: var(--accent-primary); }
        .specialty-card:hover .icon, .facility-type-card:hover .icon, .plc-card:hover .icon { color: var(--accent-primary); transform: scale(1.18); }
        .plc-card:hover .plc-photo { transform: scale(1.05); }

        /* --- Enhanced Selected Card Style --- */
        .facility-type-card.card-selected, .plc-card.card-selected { border-color: var(--accent-primary-dark); box-shadow: 0 6px 12px var(--shadow-color-medium); background-color: var(--bg-accent-very-light); transform: translateY(-5px) scale(1.02); position: relative; }
        .facility-type-card.card-selected h4, .plc-card.card-selected h4 { color: var(--accent-primary-dark); font-weight: 700; }
        .facility-type-card.card-selected::after, .plc-card.card-selected::after { content: '\f00c'; font-family: 'Font Awesome 6 Free'; font-weight: 900; position: absolute; top: 8px; right: 8px; font-size: 0.8rem; color: var(--bg-primary); background-color: var(--accent-primary); border-radius: 50%; width: 22px; height: 22px; display: flex; align-items: center; justify-content: center; box-shadow: 0 1px 3px rgba(0,0,0,0.2); z-index: 2; animation: zoomIn 0.3s ease-out; }
        .facility-type-card.card-selected:hover, .plc-card.card-selected:hover { transform: translateY(-6px) scale(1.02); box-shadow: 0 8px 18px var(--shadow-color-medium); border-color: var(--accent-primary-dark); background-color: var(--bg-accent-very-light); }

        /* --- Trust Factors Section --- */
        .trust-factors-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
        .trust-factor { display: flex; align-items: flex-start; gap: 1.5rem; padding: 1.5rem; background: rgba(255, 255, 255, 0.6); border-radius: 8px; transition: background-color 0.3s ease; border: 1px solid transparent; }
        .trust-factor:hover { background: var(--bg-primary); border-color: var(--border-color); }
        .trust-factor .icon { font-size: 2rem; color: var(--accent-primary); flex-shrink: 0; margin-top: 0.1rem; }
        .trust-factor h4 { font-size: 1.15rem; font-weight: 700; margin-bottom: 0.4rem; }
        .trust-factor p { color: var(--text-medium); font-size: 0.95rem; }

        /* --- Stats Section --- */
        .stats-section { background: var(--accent-primary); color: var(--text-light); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: center; }
        .stat-item { padding: 1rem; }
        .stat-item .icon { font-size: 2.8rem; margin-bottom: 1rem; opacity: 0.85; transition: transform 0.3s ease; }
        .stat-item:hover .icon { transform: scale(1.1); }
        .stat-item .stat-number { font-size: 2.8rem; font-weight: 700; font-family: 'Lato', sans-serif; margin-bottom: 0.3rem; }
        .stat-item .stat-label { font-size: 1rem; font-weight: 600; opacity: 0.9; }

        /* --- Site Reviews Display Section --- */
        .site-reviews-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2rem; }
        .site-review-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-left: 4px solid var(--accent-primary-light); border-radius: 8px; padding: 2rem; position: relative; box-shadow: 0 4px 10px var(--shadow-color); transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; display: flex; flex-direction: column; }
        .site-review-card:hover { transform: translateY(-8px); box-shadow: 0 10px 22px var(--shadow-color-medium); border-left-color: var(--accent-primary); }
        .site-review-card::before { content: '\f10d'; font-family: 'Font Awesome 6 Free'; font-weight: 900; font-size: 3rem; color: var(--accent-primary); opacity: 0.1; position: absolute; top: 0.8rem; left: 1.2rem; z-index: 0; }
        .site-review-card .stars { display: flex; gap: 4px; font-size: 1.3em; margin-bottom: 1.2rem; justify-content: flex-start; position: relative; z-index: 1; }
        .site-review-card .stars .fas.fa-star, .site-review-card .stars .fas.fa-star-half-alt { color: var(--accent-warm); }
        .site-review-card .stars .far.fa-star { color: var(--border-color-strong); }
        .site-review-comment { font-style: italic; color: var(--text-medium); margin-bottom: 1.5rem; position: relative; z-index: 1; flex-grow: 1; font-size: 1.05rem; }
        .site-review-author { display: flex; align-items: center; gap: 1rem; margin-top: auto; z-index: 1; padding-top: 1rem; border-top: 1px solid var(--border-color); }
        .site-review-author i { font-size: 1.5rem; color: var(--text-medium); width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background-color: var(--border-color); border-radius: 50%; flex-shrink: 0; }
        .site-review-author h5 { font-size: 1.05rem; font-weight: 700; margin: 0; color: var(--text-dark); }
        .site-review-author span { display: none; }

         /* --- Site Review Submission Form --- */
        #site-review-form-section .form-container { max-width: 700px; margin: 0 auto; background-color: var(--bg-primary); padding: 3rem; border-radius: 12px; box-shadow: 0 6px 18px var(--shadow-color-medium); border: 1px solid var(--border-color); }
        #site-review-form-section h3 { text-align: center; font-size: 1.8rem; border-bottom: none; margin-bottom: 2.5rem; color: var(--text-dark); }
        #site-review-form-section h3::after { display: none; }
        #site-review-form-section .form-group { margin-bottom: 1.8rem; }
        #site-review-form-section label { font-weight: 600; margin-bottom: 0.6rem; display: block; color: var(--text-dark); }
        #site-review-form-section input[type="text"], #site-review-form-section textarea { width: 100%; padding: 0.9rem 1rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; background: var(--bg-primary); color: var(--text-dark); }
         #site-review-form-section textarea { min-height: 130px; resize: vertical; }
         #site-review-form-section .rating-input { display: flex; justify-content: center; align-items: center; gap: 8px; margin-bottom: 1.5rem; flex-direction: row-reverse; }
         #site-review-form-section .rating-input input[type="radio"] { display: none; }
         #site-review-form-section .rating-input label { font-size: 2rem; color: var(--border-color-strong); cursor: pointer; transition: color 0.2s ease, transform 0.2s ease; }
         #site-review-form-section .rating-input label:hover { transform: scale(1.15); }
         #site-review-form-section .rating-input input[type="radio"]:checked ~ label, #site-review-form-section .rating-input label:hover ~ label { color: var(--accent-warm); transform: scale(1.15); }
        #site-review-form button[type="submit"] { background-color: var(--accent-primary-dark); width: 100%; }

        /* --- Doctors Grid (Search Results) --- */
        .doctors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.8rem;
            align-items: start;
        }

        /* --- UPDATED Doctor Card (Overall Structure) --- */
        .doctor-card {
            background: var(--bg-primary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            padding: 1.2rem;
            transition: transform var(--transition-speed) var(--transition-ease),
                        box-shadow var(--transition-speed) var(--transition-ease),
                        border-color var(--transition-speed) var(--transition-ease);
            box-shadow: 0 4px 10px var(--shadow-color);
            height: 100%; /* Ensure cards in same row have same height */
        }
        .doctor-card:hover {
            transform: translateY(-6px);
            border-color: var(--accent-primary-light);
            box-shadow: 0 10px 20px var(--shadow-color-medium);
        }

        /* --- Doctor Card Top Section (Photo + Primary Info) --- */
        .doctor-card-top {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem; /* Space below top row */
            width: 100%;
        }

        /* --- Doctor Photo (Within Top Section) --- */
        .doctor-photo {
            width: 75px;
            height: 75px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
            flex-shrink: 0;
            border: 2px solid var(--border-color);
            transition: border-color var(--transition-speed) var(--transition-ease), transform var(--transition-speed) var(--transition-ease);
        }
        .doctor-card:hover .doctor-photo {
             border-color: var(--accent-primary);
             transform: scale(1.05);
        }

        /* --- Doctor Primary Info (Name, Spec, Rating - Within Top Section) --- */
        .doctor-primary-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex-grow: 1;
            min-width: 0;
            line-height: 1.4;
        }
        .doctor-primary-info h3 {
            color: var(--text-dark);
            margin-bottom: 0.15rem;
            font-size: 1.15rem;
            font-weight: 700;
            transition: color var(--transition-speed) var(--transition-ease);
        }
        .doctor-card:hover .doctor-primary-info h3 {
            color: var(--accent-primary-dark);
        }
        .doctor-primary-info .specialization {
            color: var(--accent-primary);
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .doctor-primary-info .rating-display {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            margin-bottom: 0;
            font-size: 0.85rem;
        }
        .doctor-primary-info .rating-display .stars { display: flex; gap: 2px; font-size: 1em; }
        .doctor-primary-info .rating-display .stars .fas.fa-star,
        .doctor-primary-info .rating-display .stars .fas.fa-star-half-alt { color: var(--accent-warm); }
        .doctor-primary-info .rating-display .stars .far.fa-star { color: var(--border-color-strong); }
        .doctor-primary-info .rating-display .review-count { color: var(--text-medium); font-size: 0.8rem; }
        .doctor-primary-info .rating-display .no-reviews { font-style: italic; color: var(--text-medium); font-size: 0.8rem; }

        /* --- Doctor Info (Bottom Section Container) --- */
        .doctor-info {
            /* Removed border-top here */
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            line-height: 1.5;
            flex-grow: 1; /* Allow section to grow */
            margin-top: 0; /* Reset margin-top */
        }

        /* --- Doctor Details (Within Bottom Section) --- */
        .doctor-details {
            font-size: 0.85rem;
            color: var(--text-medium);
            margin-bottom: 0.8rem; /* Space before separator line */
            width: 100%;
            text-align: left;
        }
        .doctor-details p { margin-bottom: 0.4rem; display: flex; align-items: center; justify-content: flex-start; }
        .doctor-details i { margin-right: 0.6rem; color: var(--accent-primary-light); width: 1.3em; text-align: center; transition: color var(--transition-speed) var(--transition-ease); flex-shrink: 0; }
        .doctor-card:hover .doctor-details i { color: var(--accent-primary); }
        .doctor-details i.fa-map-pin, .doctor-details i.fa-map-marker-alt,
        .doctor-details i.fa-hospital, .doctor-details i.fa-clinic-medical { color: var(--accent-primary); }

        /* --- Availability Details Section (Within Bottom Section) --- */
        .availability-details {
            font-size: 0.85rem;
            color: var(--text-medium);
            width: 100%;
            text-align: left;
            border-top: 1px solid var(--border-color); /* Separator LINE added here */
            padding-top: 0.8rem; /* Space above availability text */
            margin-bottom: 1rem; /* Space before button */
        }
        .availability-details .availability-title {
            display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: var(--text-dark); margin-bottom: 0.4rem;
        }
        .availability-details .availability-title i { color: var(--accent-primary); font-size: 1em; }
        .availability-details p { margin-bottom: 0.25rem; padding-left: 1.8em; line-height: 1.4; }
        .availability-details p:last-child { margin-bottom: 0; }


        /* --- Booking button styling (Within Bottom Section) --- */
        .book-btn {
            margin-top: auto; /* Pushes button to the bottom */
            width: auto;
            font-size: 0.9rem;
            padding: 0.5rem 1.2rem;
            align-self: flex-start; /* Align button left */
        }


        /* --- No Results Message --- */
        #noResultsMessage { color: var(--text-medium); text-align: center; padding: 6rem 1rem; font-size: 1.15rem; display: none; }
        #noResultsMessage i { display: block; font-size: 4rem; margin-bottom: 1.5rem; color: var(--border-color-strong); animation: zoomIn 0.8s ease-out; }

        /* --- Footer --- */
        .footer { background: #1A202C; color: #a0aec0; padding: 5rem 5% 2rem; margin-top: 0; border-top: 5px solid var(--accent-primary); }
        .footer-content { max-width: 1280px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 3.5rem; margin-bottom: 4rem; }
        .footer-section h3 { color: var(--text-light); margin-bottom: 1.5rem; font-size: 1.25rem; font-weight: 700; position: relative; padding-bottom: 0.7rem; }
        .footer-section h3::after { content: ''; position: absolute; bottom: 0; left: 0; width: 45px; height: 3px; background-color: var(--accent-primary); border-radius: 1px; }
        .footer-section p { font-size: 0.95rem; line-height: 1.7; margin-bottom: 1rem; }
        .footer-links { display: flex; flex-direction: column; gap: 0.9rem; }
        .footer-links a { color: #cbd5e0; text-decoration: none; transition: color var(--transition-speed) var(--transition-ease), padding-left var(--transition-speed) var(--transition-ease), transform var(--transition-speed) var(--transition-ease); display: flex; align-items: center; gap: 0.7rem; }
        .footer-links a i { font-size: 0.8em; opacity: 0.7; transition: opacity 0.3s ease; }
        .footer-links a:hover { color: var(--text-light); padding-left: 8px; transform: translateX(2px); text-decoration: none; }
        .footer-links a:hover i { opacity: 1; }
        .social-links { display: flex; gap: 1.3rem; margin-top: 1.5rem; }
        .social-links a { font-size: 1.6rem; color: #cbd5e0; transition: color var(--transition-speed) var(--transition-ease), transform var(--transition-speed) var(--transition-ease); }
        .social-links a:hover { color: var(--accent-primary-light); transform: translateY(-4px) rotate(-5deg); }
        .copyright { text-align: center; padding-top: 2.5rem; border-top: 1px solid #4a5568; color: #a0aec0; font-size: 0.9rem; }

        /* --- Flash Messages --- */
        .flash-messages { position: fixed; top: 90px; right: 20px; z-index: 1050; width: clamp(300px, 90%, 420px); }
        .flash-message { padding: 1rem 1.5rem; margin-bottom: 1rem; border-radius: 8px; font-weight: 600; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.18); opacity: 0; transform: translateX(100%); animation: slideInFadeOut 5s ease-in-out forwards; border: 1px solid transparent; display: flex; align-items: center; gap: 1rem; background-color: var(--bg-primary); }
        .flash-message::before { font-family: "Font Awesome 6 Free"; font-weight: 900; font-size: 1.3em; }
        .flash-message.success { border-left: 6px solid var(--success); color: #046c4e; }
        .flash-message.success::before { content: '\f058'; color: var(--success); }
        .flash-message.error { border-left: 6px solid var(--error); color: #9b1c1c; }
        .flash-message.error::before { content: '\f071'; color: var(--error); }
        .flash-message.info { border-left: 6px solid var(--info); color: #1e40af; }
        .flash-message.info::before { content: '\f05a'; color: var(--info); }
        @keyframes slideInFadeOut { 0% { opacity: 0; transform: translateX(100%); } 10% { opacity: 1; transform: translateX(0); } 90% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; transform: translateX(100%); } }


        /* --- Responsive Design --- */
        @media (max-width: 1024px) {
            .hero-title { font-size: 2.5rem; }
            .hero-section { padding: 5rem 5% 4rem; }
            .container { width: 95%; padding: 0 0.8rem; }
            .section-padding { padding: 4rem 0; }
            .section-padding-sm { padding: 2.5rem 0; }
            .featured-specialties-grid, .featured-facility-types-grid, .featured-plcs-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.5rem; }
            .search-area-container { max-width: 90%; padding: 2rem 1.5rem; }
            .search-form { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
            .site-reviews-grid { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
            .search-button-container .btn.search-btn { flex-basis: 200px; }
            .doctors-grid { gap: 1.5rem; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
            .doctor-card { padding: 1rem; }
            .doctor-photo { width: 70px; height: 70px; }
            .doctor-card-top { gap: 0.9rem; margin-bottom: 0.8rem;}
            .doctor-primary-info h3 { font-size: 1.1rem;}
            .doctor-info { /* No specific changes needed here now */ }
            .doctor-details { font-size: 0.8rem;}
            .availability-details { font-size: 0.8rem; margin-bottom: 0.8rem; padding-top: 0.7rem;}
            .availability-details p { padding-left: 1.6em;}
            .book-btn { font-size: 0.85rem; padding: 0.4rem 1rem;}
        }

        @media (max-width: 768px) {
            .hero-title { font-size: 2.1rem; }
            .hero-subtitle { font-size: 1.1rem; max-width: 90%; }
            .hero-section { padding: 4rem 5% 3rem; }
            .section-title { font-size: 1.8rem; margin-bottom: 2.5rem;}
            .section-subtitle { font-size: 1rem; margin-top: -1.5rem; margin-bottom: 2.5rem; }
            .section-padding { padding: 3rem 0; }
            .section-padding-sm { padding: 2rem 0; }
            .btn { padding: 0.65rem 1.3rem; font-size: 0.9rem; }
            .nav-actions { gap: 0.6rem; }
            .doctors-grid { grid-template-columns: 1fr; gap: 1.2rem;} /* Stack doctors */
            .footer-content { gap: 2.5rem; }
            .flash-messages { top: 75px; width: clamp(280px, 95%, 380px);}
            .featured-specialties-grid, .featured-facility-types-grid, .featured-plcs-grid { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1.2rem; }
            .plc-card, .specialty-card, .facility-type-card { min-height: 190px; }
            .plc-photo { height: 90px; }
            .search-area-container { padding: 1.8rem 1rem; backdrop-filter: blur(2px); }
            .search-form { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.2rem; }
            .site-reviews-grid { grid-template-columns: 1fr; }
            .search-button-container { gap: 0.8rem; }
            .search-button-container .btn.search-btn { flex-basis: auto; flex-grow: 1; max-width: 300px; }
            #site-review-form-section .form-container { padding: 2.5rem 1.5rem; }
            .trust-factors-grid { grid-template-columns: 1fr; }
            .doctor-photo { width: 65px; height: 65px; }
            .doctor-card-top { gap: 0.8rem; margin-bottom: 0.7rem;}
            .doctor-primary-info h3 { font-size: 1rem;}
        }

        @media (max-width: 480px) {
            body { line-height: 1.5; }
            .hero-title { font-size: 1.9rem; line-height: 1.4; }
            .hero-subtitle { font-size: 1rem; }
            .hero-section { padding: 3rem 5% 2.5rem; }
            .nav-actions .btn-secondary { display: none; }
            .logo { font-size: 1.6rem; }
            .logo i { font-size: 1.4rem; }
            .how-it-works-grid, .how-it-works-grid-standalone, .stats-grid { grid-template-columns: 1fr; gap: 1.5rem; }
            .doctors-grid { gap: 1rem; } /* Stacked already */

            /* --- RESPONSIVE DOCTOR CARD (Small screens) --- */
             .doctor-card { padding: 0.9rem; }
             .doctor-card-top { flex-direction: row; align-items: flex-start; gap: 0.8rem; margin-bottom: 0.7rem; }
             .doctor-photo { width: 60px; height: 60px; }
             .doctor-primary-info h3 { font-size: 1rem; }
             .doctor-primary-info .specialization { font-size: 0.8rem; margin-bottom: 0.3rem; }
             .doctor-primary-info .rating-display { font-size: 0.8rem; }
             .doctor-info { /* No specific changes needed */ }
             .doctor-details { font-size: 0.8rem; margin-bottom: 0.6rem; }
             .doctor-details p { margin-bottom: 0.2rem; }
             .availability-details { font-size: 0.8rem; margin-bottom: 0.8rem; padding-top: 0.6rem;}
             .availability-details p { padding-left: 0; } /* Remove indent on mobile */
             .availability-details .availability-title { margin-bottom: 0.3rem;}
             .book-btn { font-size: 0.85rem; padding: 0.4rem 1rem; margin-top: 0.8rem; }
             /* End Responsive Doctor Card */

            .stat-number { font-size: 2.4rem; }
            .footer-content { text-align: center; grid-template-columns: 1fr; gap: 2rem;}
            .footer-section h3::after { left: 50%; transform: translateX(-50%); }
            .social-links { justify-content: center; }
            .footer-links { align-items: center; }
            .footer-links a { justify-content: center; }
            .footer-links a:hover { padding-left: 0; transform: none; }
            .featured-specialties-grid, .featured-facility-types-grid, .featured-plcs-grid { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
            .plc-card, .specialty-card, .facility-type-card { min-height: 170px; }
            .plc-photo { height: 80px; }
            .specialty-card .icon, .facility-type-card .icon, .plc-card .icon { font-size: 2rem; }
            .specialty-card h4, .facility-type-card h4, .plc-card h4 { font-size: 0.9rem; }
            .btn-small { padding: 0.3rem 0.7rem; font-size: 0.8rem; }
            .search-area-container { margin-top: 2rem; padding: 1.5rem 0.8rem; background-color: rgba(255, 255, 255, 0.9); backdrop-filter: none; border-radius: 8px; }
            .search-form { grid-template-columns: 1fr; gap: 1rem; }
            select, input[type="text"] { font-size: 0.95rem; height: 44px; padding-left: 2.5rem; }
            .input-group i { left: 0.8rem; }
            select { padding-right: 2.5rem; background-position: right 0.8rem center; }
            .search-button-container .btn.search-btn { width: 100%; max-width: none; padding: 0.7rem 1rem; font-size: 1rem; }
            #site-review-form-section .form-container { padding: 2rem 1rem; border-radius: 8px; }
            #site-review-form-section h3 {font-size: 1.5rem;}
            #site-review-form-section .rating-input label { font-size: 1.8rem; }
            .section-padding { padding: 2.5rem 0; }
            .section-padding-sm { padding: 1.5rem 0; }
            .flash-messages { width: 90%; left: 5%; right: 5%; top: 70px; }
        }

    </style>

</head>
<body>

    <!-- Flash Messages Container -->
    <div class="flash-messages">
        {# Flask/Jinja specific: Render flashed messages passed from the backend #}
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    {% set category_class = category if category in ['success', 'error', 'info'] else 'info' %}
                    <div class="flash-message {{ category_class }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>
    <!-- Flash Messages Container End -->

    <!-- Navbar Start -->
    <nav class="navbar" id="navbar">
        <div><a href="/" class="logo"><i class="fas fa-heart-pulse"></i> CareConnect</a></div>
        <div class="nav-actions"><button class="btn btn-secondary" onclick="window.location.href='/doctor-login'">For Providers</button></div>
        <div><button class="btn btn-primary" onclick="window.location.href='/patient-login'">Patient Login</button></div>
    </nav>
    <!-- Navbar End -->

    <!-- Hero Section Start -->
    <section class="hero-section" id="search-section">
        <div class="container">
             <h1 class="hero-title">Find & Book <span>Clinic Appointments</span>, Effortlessly.</h1>
             <p class="hero-subtitle">Access a network of trusted doctors and specialists near you. Your health journey starts here.</p>
             <div class="typing-effect-container"> <span id="text"></span> </div>
             <div class="search-area-container reveal-on-scroll reveal-zoom">
                <h2 class="section-title" style="margin-bottom: 1.5rem; font-size: 1.5rem;">Find Your Doctor</h2>
                <form class="search-form" id="searchForm" onsubmit="event.preventDefault(); searchDoctors();">
                    <div class="input-group">
                        <i class="fas fa-map-location-dot"></i>
                        <select id="province" aria-label="Select Province">
                           <option value="">All Provinces</option>
                           {% for prov in ['Bagmati', 'Gandaki', 'Lumbini', 'Koshi', 'Madhesh', 'Sudurpashchim', 'Karnali'] %} <option value="{{ prov }}">{{ prov }}</option> {% endfor %}
                        </select>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-map-pin"></i>
                        <select id="governorate" aria-label="Select Governorate">
                           <option value="">All Governorates</option>
                           {% if governorates %} {% for gov in governorates %} <option value="{{ gov }}">{{ gov }}</option> {% endfor %} {% else %} <option value="" disabled>Loading...</option> {% endif %}
                        </select>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-stethoscope"></i>
                        <select id="specialization" aria-label="Select Specialization">
                           <option value="">All Specialties</option>
                           {% if specialties %} {% for spec in specialties %} <option value="{{ spec }}">{{ spec }}</option> {% endfor %} {% else %} <option value="" disabled>Loading...</option> {% endif %}
                        </select>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-hospital"></i>
                        <select id="facilityType" aria-label="Select Facility Type">
                           <option value="">All Facility Types</option>
                           {% if facility_types %} {% for f_type in facility_types %} <option value="{{ f_type }}">{{ f_type }}</option> {% endfor %} {% else %} <option value="" disabled>Loading...</option> {% endif %}
                        </select>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-user-doctor"></i>
                        <input type="text" id="doctorName" placeholder="Doctor, Clinic Name..." aria-label="Doctor or Clinic Name">
                    </div>
                </form>
                <div class="search-button-container">
                    <button type="button" class="btn btn-primary search-btn" onclick="searchDoctors(null, false)"><i class="fas fa-search"></i> Find Care</button>
                </div>
            </div>
        </div>
   </section>
    <!-- Hero Section End -->

    <!-- Featured Facility Types Section Start -->
    <section class="featured-facility-types-section section-padding-sm">
        <div class="container">
             <h2 class="section-title reveal-on-scroll">Explore Facility Types</h2>
             <div class="featured-facility-types-grid">
                 {% if facility_types %}
                    {% for f_type in facility_types %}
                         <div class="facility-type-card reveal-on-scroll" data-facility-type="{{ f_type }}" onclick="setFacilityTypeFilterAndSearch('{{ f_type }}', this)" role="button" tabindex="0" aria-pressed="false">
                             {% set icon_class = 'fas fa-clinic-medical' %}
                             {% if 'hospital' in f_type|lower %}{% set icon_class = 'fas fa-hospital' %} {% elif 'clinic' in f_type|lower %}{% set icon_class = 'fas fa-clinic-medical' %} {% elif 'center' in f_type|lower or 'centre' in f_type|lower or 'hub' in f_type|lower %}{% set icon_class = 'fas fa-building' %} {% elif 'post' in f_type|lower %}{% set icon_class = 'fas fa-plus-square' %} {% elif 'lab' in f_type|lower %}{% set icon_class = 'fas fa-flask-vial' %} {% endif %}
                             <i class="{{ icon_class }} icon"></i> <h4>{{ f_type }}</h4>
                         </div>
                    {% endfor %}
                 {% else %} <p class="section-subtitle" style="grid-column: 1 / -1;">Could not load facility types.</p> {% endif %}
             </div>
             <div style="text-align: center; margin-top: 2.5rem;" class="reveal-on-scroll"> <button class="btn btn-secondary" onclick="clearFacilityTypeFilterAndSearch()">View All Facility Types</button> </div>
         </div>
    </section>
    <!-- Featured Facility Types Section End -->

    <!-- Featured PLCs (Places/Clinics) Section Start -->
    <section class="featured-plcs-section section-padding-sm">
        <div class="container">
            <h2 class="section-title reveal-on-scroll">Explore Clinics & Centers</h2>
            <div class="featured-plcs-grid">
                {% if plcs %}
                   {% for plc in plcs %}
                       {% set plc_slug = plc | lower | replace(' ', '_') | replace('&', 'and') | replace('.', '') | replace("'", '') %}
                       <div class="plc-card reveal-on-scroll" data-plc-name="{{ plc }}" onclick="setPlcFilterAndSearch('{{ plc }}', this)" role="button" tabindex="0" aria-pressed="false">
                           <img src="{{ url_for('static', filename='plc_photos/' + plc_slug + '.jpg') }}" alt="Photo of {{ plc }}" class="plc-photo" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                           <i class="fas fa-hospital-user icon" style="display: none;"></i> <h4>{{ plc }}</h4>
                           <div class="plc-details-button-container"> <a href="{{ url_for('center_details', plc_name=plc) }}" class="btn btn-secondary btn-small plc-details-btn" onclick="event.stopPropagation();"><i class="fas fa-info-circle"></i> View Details</a> </div>
                       </div>
                   {% endfor %}
               {% else %} <p class="section-subtitle" style="grid-column: 1 / -1;">Could not load clinics.</p> {% endif %}
           </div>
           <div style="text-align: center; margin-top: 2.5rem;" class="reveal-on-scroll"> <button class="btn btn-secondary" onclick="clearPlcFilterAndSearch()">View All Clinics & Centers</button> </div>
        </div>
    </section>
    <!-- Featured PLCs Section End -->

    <!-- Doctors Results Section Start -->
    <section class="doctors-section section-padding" id="doctors-results">
        <div class="container">
            <h2 class="section-title" id="resultsTitle" style="display: none;">Available Doctors</h2>
            <div class="doctors-grid" id="resultsContainer" aria-live="polite"></div>
            <div id="noResultsMessage" style="display: none;"> <i class="fas fa-user-times"></i> <p>We couldn't find doctors matching your criteria.<br>Try adjusting the filters above or clear them.</p> </div>
         </div>
    </section>
    <!-- Doctors Results Section End -->

    <!-- How It Works Section Start -->
    <section class="how-it-works-section section-padding">
        <div class="container">
            <h2 class="section-title reveal-on-scroll">Booking in 3 Simple Steps</h2>
            <p class="section-subtitle reveal-on-scroll">Finding healthcare is easier than ever.</p>
            <div class="how-it-works-grid-standalone">
                 <div class="how-it-works-step reveal-on-scroll"> <i class="fas fa-search-location icon"></i> <h3>1. Search & Filter</h3> <p>Use location, specialty, facility type, or name.</p> </div>
                 <div class="how-it-works-step reveal-on-scroll"> <i class="fas fa-calendar-check icon"></i> <h3>2. Select & Book</h3> <p>See real-time slots and book instantly.</p> </div>
                 <div class="how-it-works-step reveal-on-scroll"> <i class="fas fa-notes-medical icon"></i> <h3>3. Visit Clinic</h3> <p>Attend your appointment and manage bookings online.</p> </div>
            </div>
        </div>
    </section>
    <!-- How It Works Section End -->

     <!-- Trust Factors Section Start -->
    <section class="trust-factors-section section-padding">
        <div class="container">
            <h2 class="section-title reveal-on-scroll">Why Choose CareConnect?</h2>
            <div class="trust-factors-grid">
                <div class="trust-factor reveal-on-scroll reveal-left"> <i class="fas fa-user-shield icon"></i> <div> <h4>Verified Professionals</h4> <p>Connect with licensed doctors and specialists vetted for quality.</p> </div> </div>
                <div class="trust-factor reveal-on-scroll reveal-right"> <i class="fas fa-calendar-alt icon"></i> <div> <h4>Easy Online Booking</h4> <p>Schedule appointments 24/7, hassle-free, from any device.</p> </div> </div>
                <div class="trust-factor reveal-on-scroll reveal-left"> <i class="fas fa-clock icon"></i> <div> <h4>Real-Time Availability</h4> <p>See instantly available slots and secure your appointment right away.</p> </div> </div>
                <div class="trust-factor reveal-on-scroll reveal-right"> <i class="fas fa-lock icon"></i> <div> <h4>Secure & Private</h4> <p>Your health information is kept confidential and secure.</p> </div> </div>
            </div>
        </div>
    </section>
    <!-- Trust Factors Section End -->

    <!-- Stats Section Start -->
    <section class="stats-section section-padding-sm">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-item reveal-on-scroll reveal-zoom"> <i class="fas fa-user-doctor icon"></i> <div class="stat-number" data-target="{{ stats.doctor_count | default(0) }}">{{ stats.doctor_count | default(0) }}</div> <div class="stat-label">Verified Doctors</div> </div>
                <div class="stat-item reveal-on-scroll reveal-zoom"> <i class="fas fa-stethoscope icon"></i> <div class="stat-number" data-target="{{ stats.specialty_count | default(0) }}">{{ stats.specialty_count | default(0) }}</div> <div class="stat-label">Specialties Available</div> </div>
                <div class="stat-item reveal-on-scroll reveal-zoom"> <i class="fas fa-calendar-check icon"></i> <div class="stat-number" data-target="{{ stats.total_bookings | default(0) }}">{{ stats.total_bookings | default(0) }}</div> <div class="stat-label">Appointments Booked</div> </div>
                <div class="stat-item reveal-on-scroll reveal-zoom"> <i class="fas fa-star icon"></i> <div class="stat-number" data-target="{{ stats.review_count | default(0) }}">0</div> <div class="stat-label">Patient Reviews</div> </div>
            </div>
        </div>
    </section>
    <!-- Stats Section End -->

    <!-- Site Reviews Display Section Start -->
    <section class="site-reviews-section section-padding" id="site-reviews-section">
        <div class="container">
            <h2 class="section-title reveal-on-scroll">What People Say About CareConnect</h2>
            <p class="section-subtitle reveal-on-scroll">General feedback about our platform and service.</p>
            <div class="site-reviews-grid">
                {% if site_reviews %}
                    {% for review in site_reviews %}
                    <div class="site-review-card reveal-on-scroll">
                         <div class="stars" title="{{ review.rating }}/5 Stars"> {% for star_class in get_stars(review.rating) %} <i class="{{ star_class }}"></i> {% endfor %} </div>
                         <p class="site-review-comment">"{{ review.comment | default('No comment provided.') | truncate(250) }}"</p>
                         <div class="site-review-author"> <i class="fas fa-user-check"></i> <div class="author-info"> <h5>{{ review.reviewer_name | default('Verified User') | title }}</h5> </div> </div>
                     </div>
                     {% endfor %}
                 {% else %} <p class="section-subtitle" style="grid-column: 1 / -1; margin-top: 2rem;">No platform feedback submitted yet. Be the first to share your thoughts!</p> {% endif %}
            </div>
        </div>
    </section>
    <!-- Site Reviews Display Section End -->


    <!-- Site Review FORM Section Start -->
    <section class="section-padding" id="site-review-form-section">
        <div class="container">
            <div class="form-container reveal-on-scroll">
                 <h3>Share Your Feedback About CareConnect</h3>
                 <form id="site-review-form" method="POST" action="{{ url_for('submit_site_review') }}">
                    <div class="form-group"> <label for="siteReviewerName">Your Name:</label> <input type="text" id="siteReviewerName" name="reviewer_name" required placeholder="E.g., Jane D."> </div>
                    <div class="form-group"> <label>Overall Rating:</label> <div class="rating-input"> <input type="radio" id="siteStar5" name="rating" value="5" required><label for="siteStar5" title="5 stars - Excellent"></label> <input type="radio" id="siteStar4" name="rating" value="4"><label for="siteStar4" title="4 stars - Good"></label> <input type="radio" id="siteStar3" name="rating" value="3"><label for="siteStar3" title="3 stars - Average"></label> <input type="radio" id="siteStar2" name="rating" value="2"><label for="siteStar2" title="2 stars - Fair"></label> <input type="radio" id="siteStar1" name="rating" value="1"><label for="siteStar1" title="1 star - Poor"></label> </div> </div>
                    <div class="form-group"> <label for="siteComment">Your Comments (Optional):</label> <textarea id="siteComment" name="comment" rows="5" placeholder="Tell us about your experience using the CareConnect platform..." maxlength="1000"></textarea> </div>
                    <button type="submit" class="btn btn-primary"> <i class="fas fa-paper-plane"></i> Submit Feedback </button>
                 </form>
             </div>
         </div>
    </section>
    <!-- Site Review FORM Section End -->

    <!-- Footer Start -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section reveal-on-scroll"> <h3><i class="fas fa-heart-pulse"></i> CareConnect</h3> <p>Simplifying access to healthcare. Find and book trusted doctors near you.</p> <p><i class="fas fa-phone" style="margin-right: 0.5rem;"></i> +977-1-XXXXXX</p> <p><i class="fas fa-envelope" style="margin-right: 0.5rem;"></i> support@careconnect.com</p> </div>
                <div class="footer-section reveal-on-scroll"> <h3>Quick Links</h3> <div class="footer-links"> <a href="/"><i class="fas fa-home"></i> Home</a> <a href="#search-section"><i class="fas fa-search"></i> Find Doctor</a> <a href="/patient-login"><i class="fas fa-user-circle"></i> Patient Portal</a> <a href="#"><i class="fas fa-question-circle"></i> FAQs</a> <a href="#site-reviews-section"><i class="fas fa-comments"></i> Feedback</a> </div> </div>
                <div class="footer-section reveal-on-scroll"> <h3>For Providers</h3> <div class="footer-links"> <a href="/doctor-login"><i class="fas fa-clinic-medical"></i> Provider Login</a> <a href="#"><i class="fas fa-notes-medical"></i> List Practice</a> <a href="#"><i class="fas fa-cogs"></i> Features</a> <a href="#"><i class="fas fa-hands-helping"></i> Partnership</a> </div> </div>
                <div class="footer-section reveal-on-scroll"> <h3>Follow Us</h3> <p>Stay updated:</p> <div class="social-links"> <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a> <a href="#" aria-label="Twitter"><i class="fab fa-x-twitter"></i></a> <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a> </div> <h3 style="margin-top: 1.5rem;">Legal</h3> <div class="footer-links"> <a href="#"><i class="fas fa-user-shield"></i> Privacy Policy</a> <a href="#"><i class="fas fa-file-contract"></i> Terms of Service</a> </div> </div>
            </div>
        </div>
        <div class="copyright">  <span id="copyright-year"></span> CareConnect Nepal. All Rights Reserved. </div>
    </footer>
    <!-- Footer End -->

    <!-- JavaScript Start -->
    <script>
        /**
         * CareConnect Frontend Script
         * Handles: Navbar scroll, Dynamic content (Doctors), Card selections, Animations, Forms, Initialization.
         */

        const SCROLL_THRESHOLD = 50;
        const STAGGER_BASE_DELAY = 120;
        const COUNTER_ANIMATION_DURATION = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--counter-animation-duration').trim() || '1500', 10);
        const DEBOUNCE_DELAY = 400;

        let intersectionObserver;
        let searchTimeoutId = null;
        let currentSelectedFacilityType = null;
        let currentSelectedPlcName = null;
        let isInitialLoadSearch = true;

        const allDoctorsData = {{ doctors | default([]) | tojson | safe }};
        const allGovernorates = {{ governorates | tojson | safe if governorates else '[]' }};
        const allSpecialties = {{ specialties | tojson | safe if specialties else '[]' }};
        const allFacilityTypes = {{ facility_types | tojson | safe if facility_types else '[]' }};
        const allPlcs = {{ plcs | tojson | safe if plcs else '[]' }};
        const pageStats = {{ stats | tojson | safe if stats else '{}' }};

        const navbar = document.getElementById('navbar');
        const copyrightYearEl = document.getElementById('copyright-year');
        const resultsContainer = document.getElementById('resultsContainer');
        const noResultsMessage = document.getElementById('noResultsMessage');
        const resultsTitle = document.getElementById('resultsTitle');
        const resultsSection = document.getElementById('doctors-results');
        const textElement = document.getElementById("text");
        const doctorNameInput = document.getElementById('doctorName');
        const facilityTypeSelect = document.getElementById('facilityType');
        const specializationSelect = document.getElementById('specialization');
        const governorateSelect = document.getElementById('governorate');
        const provinceSelect = document.getElementById('province');
        const searchButton = document.querySelector('.search-btn');
        const clearFiltersButton = document.getElementById('clearFiltersBtn');

        if (navbar) { window.addEventListener('scroll', () => navbar.classList.toggle('scrolled', window.scrollY > SCROLL_THRESHOLD)); }
        if (copyrightYearEl) { copyrightYearEl.textContent = new Date().getFullYear(); }

        function searchDoctorsDebounced() { clearTimeout(searchTimeoutId); searchTimeoutId = setTimeout(() => searchDoctors(null, false), DEBOUNCE_DELAY); }

        function searchDoctors(event = null, isInitial = false) {
            if (searchButton && searchButton.disabled && !isInitial) return;
            if (searchButton) { searchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Searching...'; searchButton.disabled = true; }
            if (clearFiltersButton) clearFiltersButton.disabled = true;

            isInitialLoadSearch = isInitial;
            const province = provinceSelect?.value || '';
            const governorate = governorateSelect?.value || '';
            const specialization = specializationSelect?.value || '';
            const facilityType = facilityTypeSelect?.value || '';
            const nameQuery = doctorNameInput?.value.toLowerCase().trim() || '';

            console.log("Searching with:", { province, governorate, specialization, facilityType, nameQuery });

            requestAnimationFrame(() => {
                 const filteredDoctors = allDoctorsData.filter(doctor => {
                     if (!doctor) return false;
                     const dProvince = doctor.province || ''; const dGov = doctor.governorate || ''; const dSpec = doctor.specialization || ''; const dFac = doctor.facility_type || ''; const dName = (doctor.name || '').toLowerCase(); const dClinic = (doctor.plc || '').toLowerCase();
                     const provMatch = !province || dProvince === province; const govMatch = !governorate || dGov === governorate; const specMatch = !specialization || dSpec === specialization; const facMatch = !facilityType || dFac === facilityType; const nameMatch = !nameQuery || dName.includes(nameQuery) || dClinic.includes(nameQuery);
                     return provMatch && govMatch && specMatch && facMatch && nameMatch;
                 });
                 console.log("Found doctors:", filteredDoctors.length);
                 displayResults(filteredDoctors);
                 if (searchButton) { searchButton.innerHTML = '<i class="fas fa-search"></i> Find Care'; searchButton.disabled = false; }
                 if (clearFiltersButton) clearFiltersButton.disabled = false;
                 if (!isInitialLoadSearch && filteredDoctors.length > 0 && resultsSection) { setTimeout(() => { resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' }); }, 150); }
                 isInitialLoadSearch = false;
            });
        }

        function clearAllFilters() {
            console.log("Clearing all search filters.");
            if (provinceSelect) provinceSelect.value = ''; if (governorateSelect) governorateSelect.value = ''; if (specializationSelect) specializationSelect.value = ''; if (facilityTypeSelect) facilityTypeSelect.value = ''; if (doctorNameInput) doctorNameInput.value = '';
            currentSelectedFacilityType = null; currentSelectedPlcName = null;
            updateCardSelection(null, 'facility-type-card'); updateCardSelection(null, 'plc-card');
            filterPlcCardsByFacilityType(null);
            searchDoctors(null, false);
            const searchArea = document.getElementById('search-section');
            if(searchArea) { setTimeout(() => { searchArea.scrollIntoView({ behavior: 'smooth', block: 'start' }); }, 50); }
        }

        function getStarsHTML(rating) {
             if (rating === null || typeof rating !== 'number' || rating < 0 || rating > 5) return '<span class="stars"><i class="far fa-star"></i>'.repeat(5) + '</span>';
             rating = Math.max(0, Math.min(5, rating));
             const full = Math.floor(rating); const half = (rating - full) >= 0.4 ? 1 : 0; const empty = 5 - full - half;
             let html = '<span class="stars" title="' + rating.toFixed(1) + '/5 Stars">';
             html += '<i class="fas fa-star"></i>'.repeat(full); html += half ? '<i class="fas fa-star-half-alt"></i>' : ''; html += '<i class="far fa-star"></i>'.repeat(empty); html += '</span>'; return html;
        }

        function displayResults(doctors) {
            if (!resultsContainer || !noResultsMessage || !resultsTitle) { console.error("Missing display elements for results."); return; }
            resultsContainer.innerHTML = ''; resultsContainer.style.opacity = '0';

            if (!Array.isArray(doctors) || doctors.length === 0) {
                noResultsMessage.style.display = 'block'; resultsContainer.style.display = 'none'; resultsTitle.style.display = 'none';
            } else {
                noResultsMessage.style.display = 'none'; resultsContainer.style.display = 'grid'; resultsTitle.style.display = 'block';
                resultsTitle.textContent = `Found ${doctors.length} Doctor${doctors.length !== 1 ? 's' : ''}`;

                doctors.forEach((doctor, index) => {
                    if (!doctor || !doctor.id) return;
                    const card = document.createElement('div');
                    card.className = 'doctor-card reveal-on-scroll'; card.style.animationDelay = `${index * STAGGER_BASE_DELAY}ms`;

                    // Match CSS size (75px ~ 150x150)
                    const photoUrl = doctor.photo || `https://ui-avatars.com/api/?name=${encodeURIComponent(doctor.name || 'Doctor')}&background=e0f2f2&color=005f5f&size=150x150`;
                    const name = doctor.name || 'Doctor Name Unavailable'; const spec = doctor.specialization || 'General Practice'; const ratingValue = doctor.average_rating; const reviewCount = doctor.review_count || 0; const prov = doctor.province || ''; const gov = doctor.governorate || ''; const facType = doctor.facility_type || 'N/A'; const avail = doctor.availability1shortform || null; const clinic = doctor.plc || null; const bookingUrl = `/booking/${doctor.id}`;

                    let ratingHTML = '';
                    if (reviewCount > 0 && typeof ratingValue === 'number') { ratingHTML = `<div class="rating-display">${getStarsHTML(ratingValue)} <span class="review-count">(${reviewCount} review${reviewCount !== 1 ? 's' : ''})</span></div>`; }
                    else { ratingHTML = `<div class="rating-display"><span class="review-count no-reviews"><i class="far fa-star" style="color: var(--text-medium); margin-right: 4px;"></i>No reviews yet</span></div>`; }
                    let locationHTML = '';
                    if (prov || gov) { locationHTML = `<p><i class="fas fa-map-marker-alt"></i> ${prov}${prov && gov ? ', ' : ''}${gov}</p>`; }

                    // --- Availability Formatting ---
                    let availabilityHTML = '';
                    if (avail && avail.trim() !== '') {
                        const availabilityLines = avail.split(',')
                            .map(part => part.trim())
                            .filter(part => part !== '')
                            .map(part => `<p>${part}</p>`)
                            .join('');
                        if (availabilityLines) {
                             availabilityHTML = `<div class="availability-details">
                                                    <div class="availability-title"><i class="far fa-clock"></i>Availability:</div>
                                                    ${availabilityLines}
                                                </div>`;
                        } else {
                            availabilityHTML = `<div class="availability-details">
                                                   <div class="availability-title"><i class="far fa-clock"></i>Availability:</div>
                                                   <p>Click Book Now for details</p>
                                               </div>`;
                        }
                    } else {
                        availabilityHTML = `<div class="availability-details">
                                               <div class="availability-title"><i class="far fa-clock"></i>Availability:</div>
                                               <p>Not specified</p>
                                           </div>`;
                    }
                    // --- End Availability Formatting ---


                    // --- HTML Structure ---
                    card.innerHTML = `
                         <div class="doctor-card-top">
                             <img src="${photoUrl}" class="doctor-photo" alt="Photo of ${name}" loading="lazy" onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=e0f2f2&color=005f5f&size=150x150';">
                             <div class="doctor-primary-info">
                                 <h3>${name}</h3>
                                 <p class="specialization">${spec}</p>
                                 ${ratingHTML}
                             </div>
                         </div>
                         <div class="doctor-info"> {# Bottom section container #}
                              <div class="doctor-details">
                                  ${locationHTML}
                                  ${clinic ? `<p><i class="fas fa-clinic-medical"></i> ${clinic}</p>` : ''}
                                  <p><i class="fas fa-hospital"></i> Facility: ${facType}</p>
                               </div>
                               ${availabilityHTML} {# Placed after details, separated by its own border-top #}
                               <button class="btn btn-primary book-btn" onclick="window.location.href='${bookingUrl}'">
                                  <i class="far fa-calendar-check"></i> Book Now
                               </button>
                           </div>`;
                    // --- End HTML Structure ---

                    resultsContainer.appendChild(card);
                });
                setupScrollObserver();
                setTimeout(() => { resultsContainer.style.opacity = '1'; }, 50);
            }
        }

        function updateCardSelection(selectedCard, categoryClass) {
            document.querySelectorAll(`.${categoryClass}`).forEach(card => { card.classList.remove('card-selected'); card.setAttribute('aria-pressed', 'false'); if (card.classList.contains('card-selected')) card.style.transition = ''; });
            if (selectedCard && selectedCard.classList.contains(categoryClass)) { selectedCard.classList.add('card-selected'); selectedCard.setAttribute('aria-pressed', 'true'); }
        }

        function filterPlcCardsByFacilityType(selectedType) {
             const plcCards = document.querySelectorAll('.plc-card'); let visibleCount = 0;
             plcCards.forEach(card => {
                const plcName = card.getAttribute('data-plc-name'); if (!plcName) { card.style.display = 'none'; return; }
                const plcData = allDoctorsData.find(doc => doc.plc === plcName); const plcFacType = plcData ? plcData.facility_type : null;
                if (!selectedType || (plcFacType && plcFacType === selectedType)) { card.style.display = 'flex'; visibleCount++; }
                else { card.style.display = 'none'; }
             });
             console.log(`Visible PLC cards for type '${selectedType || 'All'}': ${visibleCount}`);
        }

        function setFacilityTypeFilterAndSearch(type, cardElement) {
             console.log(`Set Facility Type: ${type}`);
             if (cardElement?.classList.contains('card-selected')) { clearFacilityTypeFilterAndSearch(); return; }
             currentSelectedFacilityType = type; currentSelectedPlcName = null;
             updateCardSelection(cardElement, 'facility-type-card'); updateCardSelection(null, 'plc-card');
             if (facilityTypeSelect) facilityTypeSelect.value = type; if (doctorNameInput) doctorNameInput.value = '';
             filterPlcCardsByFacilityType(type); searchDoctors(null, false);
         }
        function clearFacilityTypeFilterAndSearch() {
            console.log("Clear Facility Type Filter"); currentSelectedFacilityType = null;
            updateCardSelection(null, 'facility-type-card'); if (facilityTypeSelect) facilityTypeSelect.value = "";
            filterPlcCardsByFacilityType(null); searchDoctors(null, false);
        }
        function setPlcFilterAndSearch(plcName, cardElement) {
            console.log(`Set PLC: ${plcName}`); if (!plcName || !cardElement) return;
             if (cardElement.classList.contains('card-selected')) { clearPlcFilterAndSearch(); return; }
             currentSelectedPlcName = plcName;
             const plcData = allDoctorsData.find(doc => doc.plc === plcName); const assocFacType = plcData ? plcData.facility_type : null; currentSelectedFacilityType = assocFacType;
             updateCardSelection(cardElement, 'plc-card');
             const facCard = assocFacType ? document.querySelector(`.facility-type-card[data-facility-type="${assocFacType}"]`) : null; updateCardSelection(facCard, 'facility-type-card');
             if (doctorNameInput) doctorNameInput.value = plcName; if (facilityTypeSelect) facilityTypeSelect.value = assocFacType || '';
             if (cardElement.style.display === 'none') { cardElement.style.display = 'flex'; }
             searchDoctors(null, false);
         }
         function clearPlcFilterAndSearch() {
             console.log("Clear PLC Filter"); currentSelectedPlcName = null; updateCardSelection(null, 'plc-card');
             if (doctorNameInput && allPlcs.includes(doctorNameInput.value)) { doctorNameInput.value = ""; }
             filterPlcCardsByFacilityType(currentSelectedFacilityType); searchDoctors(null, false);
         }

        const textsToType = ["Need a specialist?", "Book check-ups online.", "Access verified doctors.", "Your health, scheduled simply."];
        let textIndex = 0; let charIndex = 0; let isDeleting = false; let typingTimeout;
        const typeSpeed = 90; const deleteSpeed = 50; const pauseBeforeDelete = 2200; const pauseBeforeType = 300;
        function type() {
            clearTimeout(typingTimeout); if (!textElement) return;
            const currentText = textsToType[textIndex]; let typeDelay;
            textElement.style.animationPlayState = 'paused';
            if (!isDeleting) { textElement.textContent = currentText.slice(0, ++charIndex); if (charIndex === currentText.length) { isDeleting = true; typeDelay = pauseBeforeDelete; } else { typeDelay = typeSpeed + (Math.random() - 0.5) * 50; } }
            else { textElement.textContent = currentText.slice(0, --charIndex); if (charIndex === 0) { isDeleting = false; textIndex = (textIndex + 1) % textsToType.length; typeDelay = pauseBeforeType; } else { typeDelay = deleteSpeed; } }
            textElement.style.animationPlayState = 'running'; typingTimeout = setTimeout(type, typeDelay);
        }

        function animateCounter(element) {
             if (!element) return; const targetStr = element.dataset.target; if (element.dataset.animated === 'true' || !targetStr) return; const target = parseInt(targetStr, 10); if (isNaN(target)) return; element.dataset.animated = 'true'; if (target === 0) { element.textContent = '0'; return; }
             let startTimestamp = null; const duration = COUNTER_ANIMATION_DURATION;
             const step = (timestamp) => { if (!startTimestamp) startTimestamp = timestamp; const elapsed = timestamp - startTimestamp; const progress = Math.min(elapsed / duration, 1); const easedProgress = 1 - Math.pow(1 - progress, 3); const currentValue = Math.floor(easedProgress * target); element.textContent = currentValue.toLocaleString(); if (progress < 1) { window.requestAnimationFrame(step); } else { element.textContent = target.toLocaleString(); } }; window.requestAnimationFrame(step);
         }

        function setupScrollObserver() {
            if (intersectionObserver) { intersectionObserver.disconnect(); }
             const elements = document.querySelectorAll('.reveal-on-scroll:not(.is-visible)'); if (elements.length === 0) return;
             const options = { root: null, threshold: 0.1, rootMargin: '0px 0px -30px 0px' };
             const callback = (entries, observer) => { entries.forEach(entry => { if (entry.isIntersecting) { const el = entry.target; el.classList.add('is-visible'); if (el.classList.contains('stat-number') && el.dataset.animated !== 'true') { animateCounter(el); } else if (el.classList.contains('plc-card')) { const img = el.querySelector('img.plc-photo'); const icon = el.querySelector('i.icon'); if (img && icon && img.style.display !== 'none' && (!img.complete || img.naturalHeight === 0 || img.naturalWidth === 0)) { console.warn(`Image failed: ${img.alt || 'Unknown'}. Showing icon.`); img.style.display = 'none'; icon.style.display = 'flex'; } } observer.unobserve(el); } }); };
             intersectionObserver = new IntersectionObserver(callback, options); elements.forEach(el => { el.style.opacity = '0'; intersectionObserver.observe(el); });
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM Loaded. Initializing...");
            if (provinceSelect) provinceSelect.addEventListener('change', (e) => searchDoctors(e, false)); if (governorateSelect) governorateSelect.addEventListener('change', (e) => searchDoctors(e, false)); if (specializationSelect) specializationSelect.addEventListener('change', (e) => searchDoctors(e, false)); if (doctorNameInput) doctorNameInput.addEventListener('input', searchDoctorsDebounced); if (clearFiltersButton) clearFiltersButton.addEventListener('click', clearAllFilters);
            if (facilityTypeSelect) { facilityTypeSelect.addEventListener('change', (e) => { const selectedValue = e.target.value; currentSelectedFacilityType = selectedValue; const matchingCard = selectedValue ? document.querySelector(`.facility-type-card[data-facility-type="${selectedValue}"]`) : null; updateCardSelection(matchingCard, 'facility-type-card'); updateCardSelection(null, 'plc-card'); currentSelectedPlcName = null; if (doctorNameInput && allPlcs.includes(doctorNameInput.value)) { doctorNameInput.value = ""; } filterPlcCardsByFacilityType(selectedValue); searchDoctors(e, false); }); }
            if (doctorNameInput) { doctorNameInput.addEventListener('keypress', function(event) { if (event.key === 'Enter') { event.preventDefault(); searchDoctorsDebounced(); clearTimeout(searchTimeoutId); } }); }
            if (textElement && textsToType.length > 0) { setTimeout(type, pauseBeforeType + 500); }

            try {
                const urlParams = new URLSearchParams(window.location.search); let runInitial = false;
                function setDropdown(param, el, dataArray) { const v = urlParams.get(param); if (v && el && dataArray && dataArray.includes(v)) { el.value = v; console.log(`Set ${param} from URL: ${v}`); runInitial = true; return v; } return null; }
                const initProv = setDropdown('province', provinceSelect, ['Bagmati', 'Gandaki', 'Lumbini', 'Koshi', 'Madhesh', 'Sudurpashchim', 'Karnali']); const initGov = setDropdown('governorate', governorateSelect, allGovernorates); const initSpec = setDropdown('specialization', specializationSelect, allSpecialties); const initFac = setDropdown('facility_type', facilityTypeSelect, allFacilityTypes); const initName = urlParams.get('name'); let plcSetFromUrl = false;
                if (initName && allPlcs && allPlcs.includes(initName)) { const plcCard = document.querySelector(`.plc-card[data-plc-name="${initName}"]`); if (plcCard) { setPlcFilterAndSearch(initName, plcCard); plcSetFromUrl = true; runInitial = true; } }
                else if (initFac) { const facCard = document.querySelector(`.facility-type-card[data-facility-type="${initFac}"]`); if (facCard) { setFacilityTypeFilterAndSearch(initFac, facCard); } else { currentSelectedFacilityType = initFac; filterPlcCardsByFacilityType(initFac); runInitial = true; } }
                else if (!plcSetFromUrl) { filterPlcCardsByFacilityType(null); }
                if (initName && !plcSetFromUrl && doctorNameInput) { doctorNameInput.value = initName; runInitial = true; }
                console.log("Performing initial doctor display/search..."); searchDoctors(null, true);
            } catch (e) { console.error("Error processing URL parameters:", e); searchDoctors(null, true); filterPlcCardsByFacilityType(null); }

            setTimeout(() => { console.log("Setting up scroll observer..."); setupScrollObserver(); }, 100);
            console.log("Initialization complete.");
        });
    </script>
    <!-- JavaScript End -->

</body>
</html>
